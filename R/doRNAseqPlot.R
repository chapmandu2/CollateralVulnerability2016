#' RNAseq plot
#'
#'View RNAseq data for a given gene
#'
#' @param con A \code{SQLiteConnection} object
#' @param gene_id A vector of one or more ENSEMBL gene ids
#' @return A ggplot2 object
#' @import ggplot2
#' @export
doRNAseqPlot <- function(con, input_gene) {

    plot_data <- dplyr::src_sqlite(con@dbname) %>%
        dplyr::tbl('tcga_rnaseq_data') %>%
        dplyr::filter(gene_id == input_gene) %>%
        dplyr::collect()

    p <- ggplot(plot_data, aes(x=log2(value+0.1), fill=gene_id)) +
        geom_density() +
        geom_point(aes(y=-0.2), shape=21, position = position_jitter(h=0.1)) +
        facet_wrap(~gene_id, ncol=2) +
        theme_bw() +
        coord_flip() +
        ylab('') + xlab('log2RPKM') +
        theme(legend.position='none',
              axis.text.y=element_text(size=rel(2)),
              axis.text.x=element_text(size=0),
              axis.title=element_text(size=rel(2.5)),
              strip.text=element_text(size=rel(3)))
    return(p)

}
