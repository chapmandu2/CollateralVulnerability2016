#' getAllHumanGenes
#'
#' This function uses the \pkg{ensembldb} package to extract information on all human genes
#'
#' @param con A \code{SQLiteConnection} object
#' @return a data frame
#' @export
#' @importFrom magrittr %>%
getAllHumanGenes <- function(con) {

    all_genes <- ensembldb::genes(EnsDb.Hsapiens.v79::EnsDb.Hsapiens.v79,
                                  filter=list(ensembldb::GenebiotypeFilter('protein_coding'))) %>%
        GenomicRanges::as.data.frame() %>%
        dplyr::filter(seqnames %in% c(1:23,'X', 'Y')) %>%
        dplyr::mutate(seqnames = factor(seqnames, levels=c(1:23,'X', 'Y'))) %>%
        dplyr::arrange(seqnames, start) %>%
        dplyr::select(1:8)

    DBI::dbWriteTable(con, 'human_genes', all_genes, overwrite=T)

    return(all_genes)
}
