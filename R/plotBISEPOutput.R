#' BISEP Plot
#'
#' Plot to visualise BISEP output
#'
#' @param con A \code{SQLiteConnection} object
#' @param pi_value_th Set a PI value threshold.  Default 0.2
#' @param bisep_pval_th Set a BISEP p-value threshold.  Default 0.1
#' @return A ggplot2 object
#' @import ggplot2
#' @export
plotBISEPOutput <- function(con, pi_value_th=0.2, bisep_pval_th=0.1) {

    #get the BISEP output data
    bisep_output <- dplyr::src_sqlite(con@dbname) %>%
        dplyr::tbl('bisep_results') %>%
        dplyr::collect()

    all_genes <- DBI::dbReadTable(con, 'human_genes')

    plot_data <- bisep_output %>%
        dplyr::mutate(selected=pi_value <= pi_value_th & bisep_pval <= bisep_pval_th)

    #bisep_pval vs pi_val plot
    p1 <- ggplot(plot_data, aes(x=pi_value, y=bisep_pval, colour=selected)) +
        geom_point(size=0.3) +
        geom_vline(xintercept=0.2, colour='blue') +
        geom_hline(yintercept=0.1, colour='blue') +
        scale_y_log10() +
        theme_bw()

    return(p1)

}
