#' WormMine details table
#'
#' Extracts wormmine analysis details from the SQLite database for a given gene
#'
#' @param con A \code{SQLiteConnection} object
#' @param input_gene An ensembl gene ID
#' @return A ggplot2 object
#' @import ggplot2
#' @export
tableWormMineDetails <- function(con, input_gene) {

    sql <- sprintf("
                    select
                    t2.primaryIdentifier,
                   t2.symbol,
                   t2.alleles_primaryIdentifier,
                   t2.alleles_symbol,
                   t2.alleles_phenotypes_name,
                   t2.\"query\",
                   t2.is_lethal_worm
                   from
                   celegans_martdata t1
                   inner join wormmine_analysis_wormmine_filtered t2 on t1.celegans_homolog_ensembl_gene = t2.primaryIdentifier
                   where t1.ensembl_gene_id = '%s'
                   ", input_gene)

    DBI::dbGetQuery(con, sql) %>%
     #   dplyr::mutate(FlybaseID = sprintf('<a href="http://www.flybase.org/%s target="_blank">%s</a>',
     #                                     primaryIdentifier, primaryIdentifier)) %>%
        as.data.frame()

}
