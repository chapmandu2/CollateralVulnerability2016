#' Gene Pairs table
#'
#' For a given set of input genes, returns gene pairs for testing
#'
#' @param con A \code{SQLiteConnection} object
#' @param input_genes An vector of ensembl gene IDs
#' @return A data frame
#' @export
tableGenePairsDetails <- function(con, input_genes) {

    input_genes_txt <- paste(input_genes, collapse="','")

    sql <- sprintf("
                   select
                    t1.ensembl_gene_id as gene1_ensembl_id,
                    t2.gene_name as gene1_symbol,
                   t1.hsapiens_paralog_ensembl_gene as gene2_ensembl_id,
                   t3.gene_name as gene2_symbol
                   from
                   count_paralogs_martdata t1
                    inner join human_genes t2 on t1.ensembl_gene_id = t2.gene_id
                   inner join human_genes t3 on t1.hsapiens_paralog_ensembl_gene = t3.gene_id
                   where t1.ensembl_gene_id IN  ('%s') and t1.filter = 1
                   ", input_genes_txt)
    DBI::dbGetQuery(con, sql)

}
