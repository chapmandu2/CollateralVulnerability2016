#!/usr/bin/env ruby
#use genes "FBgn0033918,FBgn0016696,FBgn0053156,FBgn0036147,FBgn0000579"

require "rubygems"
require "intermine/service"

input = ARGV[0]
genes = input.chomp.split(",")
#print genes

service = Service.new("http://www.flymine.org/flymine")

# Get a new query from the service you will be querying:

fields = ["primaryIdentifier", "symbol", "alleles.alleleClass", "alleles.primaryIdentifier", "alleles.symbol", "alleles.phenotypeAnnotations.annotationType", "alleles.phenotypeAnnotations.description"]
fields.each { |field| print field, "\t"}
puts "\n"

service.new_query("Gene").
select(fields).
# You can edit the constraint values below
where("Gene.primaryIdentifier" => genes).
order_by("primaryIdentifier", "ASC").
#limit(10).

#now output data

each_row { |r| puts r.to_csv}

